<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Y√∂netim Paneli | Eren Kozan</title>

<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700;900&display=swap" rel="stylesheet"> 
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<style>
/* --- 1. CORE STYLES (PREMIUM DARK THEME) --- */
:root {
    --bg-dark: #121212;
    --bg-panel: #1e1e1e;
    --text-main: #e0e0e0;
    --text-muted: #a0a0a0;
    --gold: #c5a059;
    --gold-hover: #b08d4e;
    --danger: #e74c3c;
    --success: #27ae60;
    --info: #3498db;
    --border: #333;
}

* { box-sizing: border-box; outline: none; }

body {
    margin: 0; font-family: 'Inter', sans-serif;
    background-color: var(--bg-dark); color: var(--text-main);
    display: flex; height: 100vh; overflow: hidden;
}

/* --- 2. SIDEBAR --- */
.sidebar {
    width: 260px; background: var(--bg-panel); border-right: 1px solid var(--border);
    display: flex; flex-direction: column; padding: 20px;
    transition: all 0.3s ease;
}

.brand {
    font-family: 'Cinzel', serif; font-size: 22px; font-weight: 900; color: var(--gold);
    text-align: center; padding-bottom: 20px; margin-bottom: 20px;
    border-bottom: 1px solid var(--border); letter-spacing: 1px;
}

.menu { flex: 1; display: flex; flex-direction: column; gap: 8px; overflow-y: auto; }

.menu-item {
    padding: 12px 15px; color: var(--text-muted); text-decoration: none;
    border-radius: 8px; font-size: 14px; font-weight: 500;
    display: flex; align-items: center; gap: 12px; transition: all 0.2s;
    cursor: pointer; border: 1px solid transparent;
}

.menu-item:hover, .menu-item.active {
    background: rgba(197, 160, 89, 0.1); color: var(--gold);
    border-color: rgba(197, 160, 89, 0.2);
}

.menu-item i { width: 20px; text-align: center; }

.sidebar-footer { margin-top: auto; padding-top: 20px; border-top: 1px solid var(--border); display: flex; flex-direction: column; gap: 10px; }

.btn-logout {
    background: transparent; border: 1px solid var(--danger); color: var(--danger);
    padding: 10px; border-radius: 6px; cursor: pointer; font-weight: 600;
    display: flex; align-items: center; justify-content: center; gap: 8px;
    transition: all 0.3s;
}
.btn-logout:hover { background: var(--danger); color: #fff; }

.btn-reset {
    background: transparent; border: 1px solid #f39c12; color: #f39c12;
    padding: 10px; border-radius: 6px; cursor: pointer; font-weight: 600;
    display: flex; align-items: center; justify-content: center; gap: 8px;
    transition: all 0.3s;
}
.btn-reset:hover { background: #f39c12; color: #000; }

/* --- 3. MAIN CONTENT --- */
.main-content {
    flex: 1; padding: 30px; overflow-y: auto; position: relative;
}

.section { display: none; animation: fadeIn 0.4s ease; }
.section.active { display: block; }

@keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

.page-header {
    display: flex; justify-content: space-between; align-items: center;
    margin-bottom: 30px; border-bottom: 1px solid var(--border); padding-bottom: 15px;
}
.page-title { font-family: 'Cinzel', serif; font-size: 28px; color: var(--gold); margin: 0; }

/* --- DASHBOARD STATS --- */
.stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 20px; margin-bottom: 40px; }
.stat-card {
    background: var(--bg-panel); padding: 25px; border-radius: 12px; border: 1px solid var(--border);
    display: flex; align-items: center; gap: 20px; box-shadow: 0 4px 20px rgba(0,0,0,0.2);
}
.stat-icon {
    width: 50px; height: 50px; border-radius: 10px; display: flex; align-items: center; justify-content: center;
    font-size: 24px; color: #fff;
}
.icon-blue { background: linear-gradient(135deg, #3498db, #2980b9); }
.icon-gold { background: linear-gradient(135deg, #f1c40f, #f39c12); }
.icon-green { background: linear-gradient(135deg, #2ecc71, #27ae60); }
.icon-red { background: linear-gradient(135deg, #e74c3c, #c0392b); }

.stat-info h4 { margin: 0; font-size: 13px; color: var(--text-muted); text-transform: uppercase; letter-spacing: 1px; }
.stat-info p { margin: 5px 0 0 0; font-size: 24px; font-weight: 700; color: var(--text-main); }

/* --- TABLES & LISTS --- */
.card-panel {
    background: var(--bg-panel); border-radius: 12px; border: 1px solid var(--border);
    overflow: hidden; margin-bottom: 30px;
}
.panel-header {
    padding: 20px; background: rgba(255,255,255,0.02); border-bottom: 1px solid var(--border);
    display: flex; justify-content: space-between; align-items: center;
}
.panel-title { margin: 0; font-size: 18px; font-weight: 600; color: var(--gold); }

table { width: 100%; border-collapse: collapse; }
th { text-align: left; padding: 15px 20px; color: var(--text-muted); font-size: 13px; font-weight: 600; border-bottom: 1px solid var(--border); }
td { padding: 15px 20px; border-bottom: 1px solid var(--border); color: var(--text-main); font-size: 14px; vertical-align: middle; }
tr:last-child td { border-bottom: none; }
tr:hover td { background: rgba(255,255,255,0.02); }

.user-cell { display: flex; align-items: center; gap: 10px; }
.user-avatar { width: 40px; height: 40px; border-radius: 50%; object-fit: cover; border: 2px solid var(--gold); }

/* BUTTONS & ACTIONS */
.btn { border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer; font-size: 13px; font-weight: 600; transition: all 0.2s; }
.btn-primary { background: var(--gold); color: #000; }
.btn-primary:hover { background: var(--gold-hover); }
.btn-sm { padding: 6px 10px; font-size: 12px; }

.action-group { display: flex; gap: 5px; }
.btn-icon { width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; border-radius: 4px; border: none; cursor: pointer; color: #fff; transition: 0.2s; }
.btn-view { background: var(--info); }
.btn-check { background: var(--success); }
.btn-trash { background: var(--danger); }
.btn-icon:hover { opacity: 0.8; transform: translateY(-2px); }

/* FORMS */
.form-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; padding: 20px; }
.form-group { margin-bottom: 15px; }
.form-group label { display: block; margin-bottom: 8px; font-size: 13px; color: var(--text-muted); }
.form-input {
    width: 100%; padding: 12px; background: #2a2a2a; border: 1px solid var(--border);
    color: #fff; border-radius: 6px; transition: border-color 0.3s;
}
.form-input:focus { border-color: var(--gold); }

/* SERVICE CHECKBOXES */
.service-selector {
    display: grid; grid-template-columns: 1fr 1fr; gap: 10px;
    background: #2a2a2a; padding: 15px; border-radius: 6px; border: 1px solid var(--border);
}
.cb-item { display: flex; align-items: center; gap: 10px; font-size: 13px; color: #ddd; cursor: pointer; }
.cb-item input { accent-color: var(--gold); transform: scale(1.2); }

/* MODAL */
.modal-overlay {
    display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(0,0,0,0.8); z-index: 1000; align-items: center; justify-content: center;
    backdrop-filter: blur(5px);
}
.modal-overlay.active { display: flex; animation: fadeIn 0.3s; }
.modal-box {
    background: var(--bg-panel); width: 90%; max-width: 600px; border-radius: 12px;
    border: 1px solid var(--gold); overflow: hidden; box-shadow: 0 10px 40px rgba(0,0,0,0.5);
}
.modal-header {
    background: var(--bg-dark); padding: 15px 25px; border-bottom: 1px solid var(--border);
    display: flex; justify-content: space-between; align-items: center;
}
.modal-header h3 { margin: 0; color: var(--gold); font-family: 'Cinzel', serif; }
.btn-close { background: none; border: none; color: var(--text-muted); font-size: 24px; cursor: pointer; }
.btn-close:hover { color: #fff; }
.modal-body { padding: 25px; max-height: 70vh; overflow-y: auto; }

.detail-row { display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid var(--border); }
.detail-label { color: var(--text-muted); font-weight: 600; }
.detail-val { color: #fff; text-align: right; }
.note-highlight { background: rgba(52, 152, 219, 0.1); border-left: 4px solid var(--info); padding: 15px; margin-top: 15px; color: #ddd; font-style: italic; }

/* --- TAKVƒ∞M MATRƒ∞Sƒ∞ --- */
.calendar-controls {
    display: flex; gap: 15px; margin-bottom: 20px; align-items: center;
    background: #2a2a2a; padding: 15px; border-radius: 8px; border: 1px solid var(--border);
}
.matrix-table { width: 100%; border-collapse: separate; border-spacing: 4px; }
.matrix-table th { background: #333; color: var(--gold); text-align: center; padding: 10px; border-radius: 4px; position: sticky; top: 0; z-index: 10; }
.matrix-table td { padding: 0; }

.slot-btn {
    width: 100%; padding: 12px 5px; border: none; border-radius: 4px; 
    font-size: 12px; font-weight: 600; cursor: pointer; transition: all 0.2s;
    display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 4px;
    height: 60px;
}

/* Bo≈ü Slot (Ye≈üilimsi) */
.slot-empty { background: rgba(39, 174, 96, 0.1); color: #27ae60; border: 1px solid rgba(39, 174, 96, 0.3); }
.slot-empty:hover { background: #27ae60; color: #fff; }

/* Dolu Slot (Kƒ±rmƒ±zƒ±msƒ±) */
.slot-busy { background: rgba(231, 76, 60, 0.15); color: #e74c3c; border: 1px solid rgba(231, 76, 60, 0.3); cursor: not-allowed; }

/* Slot ƒ∞√ßeriƒüi */
.slot-time { font-size: 10px; opacity: 0.7; }
.slot-status { font-size: 13px; }

/* --- üì± MOBƒ∞L UYUMLULUK (V2 - GELƒ∞≈ûTƒ∞Rƒ∞LMƒ∞≈û) --- */
@media screen and (max-width: 768px) {
    
    /* 1. SIDEBAR D√úZENƒ∞ */
    .sidebar {
        width: 60px;
        padding: 10px 0;
        text-align: center;
        overflow: hidden;
    }
    .sidebar .brand, .sidebar .menu-item span { /* ƒ∞kon yanƒ±ndaki yazƒ±larƒ± gizle */
        display: none; 
    }
    .sidebar .menu-item {
        justify-content: center;
        padding: 15px 0;
    }
    .sidebar .menu-item i {
        font-size: 20px;
        margin: 0;
    }
    /* Footer butonlarƒ±nƒ± sadece ikon yap */
    .sidebar-footer button, .sidebar-footer a {
        font-size: 0; 
        padding: 10px;
        justify-content: center;
    }
    .sidebar-footer i { font-size: 18px; margin: 0; }

    /* 2. ANA ƒ∞√áERƒ∞K ALANI */
    .main-content {
        margin-left: 60px; /* Sidebar kadar bo≈üluk */
        width: calc(100% - 60px);
        padding: 15px; /* Mobilde kenar bo≈üluƒüunu azalt */
    }

    /* 3. BA≈ûLIK VE TARƒ∞H */
    .page-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 5px;
    }
    .page-title { font-size: 18px; }

    /* 4. TAKVƒ∞M KONTROLLERƒ∞ (SORUNLU KISIM BURASIYDI) */
    .calendar-controls {
        flex-direction: column; /* Alt alta diz */
        align-items: stretch; /* Tam geni≈ülik yap */
        gap: 10px;
        padding: 15px;
    }
    .calendar-controls label { margin-bottom: 5px; }
    .calendar-controls input, 
    .calendar-controls button {
        width: 100% !important; /* Kutuyu tam doldur */
        margin: 0;
        height: 45px; /* Parmakla basmak kolay olsun */
    }
    .calendar-controls span {
        text-align: center;
        margin-top: 5px;
    }

    /* 5. TABLOLAR VE MATRƒ∞S */
    .card-panel {
        padding: 10px;
        overflow-x: auto; /* Yatay kaydƒ±rma a√ß */
        -webkit-overflow-scrolling: touch; /* Akƒ±cƒ± kaydƒ±rma */
    }
    
    /* Tabloyu Sƒ±kƒ±≈ütƒ±rma, Kaydƒ±rƒ±lsƒ±n */
    table {
        width: 100%;
        min-width: 600px; /* Tablo i√ßeriƒüi en az bu kadar olsun, sƒ±ƒümazsa kayar */
    }
    
    /* H√ºcreleri K√º√ß√ºlt */
    th, td {
        padding: 8px 5px;
        font-size: 11px;
        white-space: nowrap; /* Yazƒ±lar alt satƒ±ra d√º≈ümesin */
    }

    /* Takvim Slotlarƒ±nƒ± D√ºzenle */
    .slot-btn {
        height: 45px; /* Daha kƒ±sa kutular */
        padding: 5px;
    }
    .slot-time { font-size: 9px; display: none; } /* Mobilde "Ekle+" yazƒ±sƒ± sƒ±ƒüsƒ±n diye saati gizleyebiliriz veya k√º√ß√ºltebiliriz */
    .slot-status { font-size: 10px; font-weight: bold; }

    /* 6. ƒ∞STATƒ∞STƒ∞K KARTLARI */
    .stats-grid {
        grid-template-columns: 1fr; /* Tek s√ºtun */
        gap: 15px;
    }

    /* 7. MODAL (POPUP) */
    .modal-box {
        width: 95%;
        max-height: 80vh;
    }
}

</style>
</head>
<body>

<nav class="sidebar">
    <div class="brand">Y√ñNETƒ∞M PANELƒ∞</div>
    <div class="menu">
        <div class="menu-item active" onclick="showSection('dashboard')"><i class="fas fa-th-large"></i> Genel Bakƒ±≈ü</div>
        <div class="menu-item" onclick="showSection('appointments')"><i class="fas fa-calendar-check"></i> Randevular</div>
        <div class="menu-item" onclick="showSection('reports')"><i class="fas fa-chart-line"></i> Finansal Rapor</div>
        <div class="menu-item" onclick="showSection('employees')"><i class="fas fa-user-tie"></i> √áalƒ±≈üanlar</div>
        <div class="menu-item" onclick="showSection('products')"><i class="fas fa-box-open"></i> √úr√ºnler</div>
        <div class="menu-item" onclick="showSection('reviews')"><i class="fas fa-star"></i> Yorumlar</div>
        <div class="menu-item" onclick="showSection('calendar')"><i class="fas fa-calendar-alt"></i> Takvim / M√ºsaitlik</div>
    </div>
    <div class="sidebar-footer">
        <button onclick="resetSystem()" class="btn-reset"><i class="fas fa-trash-alt"></i> Sistemi Sƒ±fƒ±rla</button>
        
        <a href="index.html" target="_blank" class="menu-item"><i class="fas fa-external-link-alt"></i> Siteye Git</a>
        <button onclick="logout()" class="btn-logout"><i class="fas fa-sign-out-alt"></i> √áƒ±kƒ±≈ü Yap</button>
    </div>
</nav>

<main class="main-content">

    <section id="dashboard" class="section active">
        <div class="page-header">
            <h1 class="page-title">Genel Bakƒ±≈ü</h1>
            <span style="color:#666;" id="currentDateDisplay"></span>
        </div>

        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon icon-blue"><i class="fas fa-clock"></i></div>
                <div class="stat-info"><h4>Bekleyen Randevu</h4><p id="stat-appt">0</p></div>
            </div>
            <div class="stat-card">
                <div class="stat-icon icon-green"><i class="fas fa-users"></i></div>
                <div class="stat-info"><h4>Aktif Personel</h4><p id="stat-emp">0</p></div>
            </div>
            <div class="stat-card">
                <div class="stat-icon icon-red"><i class="fas fa-box"></i></div>
                <div class="stat-info"><h4>√úr√ºn Sayƒ±sƒ±</h4><p id="stat-prod">0</p></div>
            </div>
            <div class="stat-card">
                <div class="stat-icon icon-gold"><i class="fas fa-coins"></i></div>
                <div class="stat-info"><h4>Bu Ay Ciro</h4><p id="stat-revenue">0 ‚Ç∫</p></div>
            </div>
        </div>
    </section>

    <section id="appointments" class="section">
        <div class="page-header"><h1 class="page-title">Randevu Takibi</h1></div>
        
        <div class="card-panel">
            <div class="panel-header">
                <h3 class="panel-title">Aktif Randevular</h3>
                <button class="btn btn-primary btn-sm" onclick="renderAppointments()"><i class="fas fa-sync"></i> Yenile</button>
            </div>
            <div class="table-responsive">
                <table>
                    <thead>
                        <tr>
                            <th>Tarih & Saat</th>
                            <th>M√º≈üteri</th>
                            <th>Hizmet & Personel</th>
                            <th>Tutar</th>
                            <th style="text-align:right;">ƒ∞≈ülemler</th>
                        </tr>
                    </thead>
                    <tbody id="appt-table-body">
                        </tbody>
                </table>
            </div>
        </div>
    </section>

    <section id="calendar" class="section">
        <div class="page-header"><h1 class="page-title">Personel M√ºsaitlik Durumu</h1></div>

        <div class="calendar-controls">
            <label style="color:#aaa;">Tarih Se√ß:</label>
            <input type="date" id="matrixDate" class="form-input" style="width:auto;" onchange="renderMatrix()">
            <button class="btn btn-primary" onclick="renderMatrix()"><i class="fas fa-sync"></i> Yenile</button>
            <span style="margin-left:auto; font-size:12px; color:#666;">*Telefondan arayan m√º≈üteriyi eklemek i√ßin BO≈û kutuya tƒ±kla.</span>
        </div>

        <div class="card-panel" style="overflow-x:auto;">
            <table class="matrix-table">
                <thead id="matrixHead">
                    </thead>
                <tbody id="matrixBody">
                    </tbody>
            </table>
        </div>
    </section>

    <section id="reports" class="section">
        <div class="page-header">
            <h1 class="page-title">Finansal Raporlar</h1>
            <input type="month" id="reportMonth" class="form-input" style="width:auto;" onchange="renderReports()">
        </div>

        <div class="stats-grid">
            <div class="stat-card" style="border-color:var(--gold);">
                <div class="stat-icon icon-gold"><i class="fas fa-wallet"></i></div>
                <div class="stat-info">
                    <h4>Se√ßilen Ay Ciro</h4>
                    <p id="monthly-total-display">0 ‚Ç∫</p>
                </div>
            </div>
        </div>

        <div class="card-panel">
            <div class="panel-header"><h3 class="panel-title">Personel Performansƒ±</h3></div>
            <table>
                <thead>
                    <tr>
                        <th>Personel</th>
                        <th>Tamamlanan ƒ∞≈ülem</th>
                        <th>Toplam Kazan√ß</th>
                    </tr>
                </thead>
                <tbody id="report-table-body"></tbody>
            </table>
        </div>
    </section>

    <section id="employees" class="section">
        <div class="page-header"><h1 class="page-title">√áalƒ±≈üan Y√∂netimi</h1></div>

        <div class="card-panel">
            <div class="panel-header"><h3 class="panel-title">Yeni √áalƒ±≈üan Ekle</h3></div>
            <form id="employeeForm" class="form-grid">
                <div class="form-group">
                    <label>Ad Soyad</label>
                    <input type="text" id="empName" class="form-input" required placeholder="√ñrn: Ahmet Usta">
                </div>
                <div class="form-group">
                    <label>√únvan</label>
                    <input type="text" id="empRole" class="form-input" required placeholder="√ñrn: Master Barber">
                </div>
                <div class="form-group">
                    <label>Fotoƒüraf URL</label>
                    <input type="text" id="empImg" class="form-input" value="img/eren_team.jpeg">
                </div>
                <div class="form-group" style="grid-column: 1 / -1;">
                    <label>Verdiƒüi Hizmetler (Fiyatlar Sabittir)</label>
                    <div class="service-selector">
                        <label class="cb-item"><input type="checkbox" name="services" value="sac-kesim" checked> Sa√ß Kesimi (800‚Ç∫)</label>
                        <label class="cb-item"><input type="checkbox" name="services" value="sakal-tras"> Sakal Tƒ±ra≈üƒ± (400‚Ç∫)</label>
                        <label class="cb-item"><input type="checkbox" name="services" value="sac-sakal"> Sa√ß & Sakal (1000‚Ç∫)</label>
                        <label class="cb-item"><input type="checkbox" name="services" value="cocuk"> √áocuk Tƒ±ra≈üƒ± (500‚Ç∫)</label>
                        <label class="cb-item"><input type="checkbox" name="services" value="fon"> F√∂n (200‚Ç∫)</label>
                        <label class="cb-item"><input type="checkbox" name="services" value="sac-duzlestirme"> Sa√ß D√ºzle≈ütirme (1500‚Ç∫)</label>
                        <label class="cb-item"><input type="checkbox" name="services" value="sac-botoksu"> Sa√ß Botoksu (400‚Ç∫)</label>
                        <label class="cb-item"><input type="checkbox" name="services" value="agda"> Aƒüda (150‚Ç∫)</label>
                        <label class="cb-item"><input type="checkbox" name="services" value="kas-tasarimi"> Ka≈ü Tasarƒ±mƒ± (300‚Ç∫)</label>
                    </div>
                </div>
                <div class="form-group" style="grid-column: 1 / -1;">
                    <label>A√ßƒ±klama</label>
                    <textarea id="empDesc" class="form-input" rows="2"></textarea>
                </div>
                <div style="grid-column: 1 / -1;">
                    <button type="submit" class="btn btn-primary" style="width:100%;">Personeli Kaydet</button>
                </div>
            </form>
        </div>

        <div class="card-panel">
            <div class="panel-header"><h3 class="panel-title">Kadro</h3></div>
            <table>
                <thead><tr><th>Personel</th><th>√únvan</th><th>Hizmet Sayƒ±sƒ±</th><th>ƒ∞≈ülem</th></tr></thead>
                <tbody id="emp-table-body"></tbody>
            </table>
        </div>
    </section>

    <section id="products" class="section">
        <div class="page-header"><h1 class="page-title">√úr√ºn Y√∂netimi</h1></div>
        
        <div class="card-panel">
            <div class="panel-header"><h3 class="panel-title">Yeni √úr√ºn Ekle</h3></div>
            <form id="productForm" class="form-grid">
                <div class="form-group"><label>√úr√ºn Adƒ±</label><input type="text" id="prodName" class="form-input" required></div>
                <div class="form-group"><label>Fiyat (TL)</label><input type="number" id="prodPrice" class="form-input" required></div>
                <div class="form-group"><label>Resim URL</label><input type="text" id="prodImg" class="form-input" value="img/product_shampoo.png"></div>
                <div class="form-group" style="grid-column: 1 / -1;"><label>A√ßƒ±klama</label><textarea id="prodDesc" class="form-input" rows="2"></textarea></div>
                <div style="grid-column: 1 / -1;"><button type="submit" class="btn btn-primary" style="width:100%;">√úr√ºn√º Ekle</button></div>
            </form>
        </div>

        <div class="card-panel">
            <div class="panel-header"><h3 class="panel-title">√úr√ºn Listesi</h3></div>
            <table>
                <thead>
                    <tr>
                        <th>Vitrin</th> <th>√úr√ºn</th>
                        <th>Fiyat</th>
                        <th>ƒ∞≈ülem</th>
                    </tr>
                </thead>
                <tbody id="prod-table-body"></tbody>
            </table>
        </div>
    </section>

    <section id="reviews" class="section">
        <div class="page-header"><h1 class="page-title">Yorum Y√∂netimi</h1></div>
        
        <div class="card-panel">
            <div class="panel-header"><h3 class="panel-title">Yorum Ekle</h3></div>
            <form id="reviewForm" class="form-grid">
                <div class="form-group"><label>Ad Soyad</label><input type="text" id="revName" class="form-input" required></div>
                <div class="form-group"><label>√únvan (√ñrn: VIP)</label><input type="text" id="revTitle" class="form-input" required></div>
                <div class="form-group"><label>Puan</label><select id="revRating" class="form-input"><option value="5">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</option><option value="4">‚≠ê‚≠ê‚≠ê‚≠ê</option></select></div>
                <div class="form-group" style="grid-column: 1 / -1;"><label>Yorum</label><textarea id="revComment" class="form-input" rows="2" required></textarea></div>
                <div style="grid-column: 1 / -1;"><button type="submit" class="btn btn-primary" style="width:100%;">Yorumu Yayƒ±nla</button></div>
            </form>
        </div>

        <div class="card-panel">
            <table><thead><tr><th>M√º≈üteri</th><th>Puan</th><th>Yorum</th><th>ƒ∞≈ülem</th></tr></thead><tbody id="review-table-body"></tbody></table>
        </div>
    </section>

</main>

<div id="modalAppt" class="modal-overlay">
    <div class="modal-box">
        <div class="modal-header"><h3>Randevu Detayƒ±</h3><button class="btn-close" onclick="closeModal('modalAppt')">&times;</button></div>
        <div class="modal-body" id="apptModalContent"></div>
    </div>
</div>

<div id="modalEmp" class="modal-overlay">
    <div class="modal-box">
        <div class="modal-header"><h3>Personel Profili</h3><button class="btn-close" onclick="closeModal('modalEmp')">&times;</button></div>
        <div class="modal-body" id="empModalContent"></div>
    </div>
</div>


<script>
    // --- SABƒ∞T Hƒ∞ZMET Fƒ∞YATLARI (TEK KAYNAK) ---
    const SERVICE_CATALOG = {
        'sac-kesim': 800,
        'sakal-tras': 400,
        'sac-sakal': 1000,
        'cocuk': 500,
        'fon': 200,
        'sac-duzlestirme': 1500,
        'sac-botoksu': 400,
        'agda': 150,
        'kas-tasarimi': 300,
        'cilt-bakim': 400 // Varsayƒ±lan eklendi
    };

    const SERVICE_NAMES = {
        'sac-kesim': 'Sa√ß Kesimi', 'sakal-tras': 'Sakal Tƒ±ra≈üƒ±', 'sac-sakal': 'Sa√ß & Sakal', 
        'cocuk': '√áocuk Tƒ±ra≈üƒ±', 'fon': 'F√∂n', 'sac-duzlestirme': 'Sa√ß D√ºzle≈ütirme',
        'sac-botoksu': 'Sa√ß Botoksu', 'agda': 'Aƒüda', 'kas-tasarimi': 'Ka≈ü Tasarƒ±mƒ±', 'cilt-bakim': 'Cilt Bakƒ±mƒ±'
    };

    // --- TEMEL ---
    if (!localStorage.getItem('isAdminLoggedIn')) window.location.href = 'admin-login.html';
    
    function getData(key) { return JSON.parse(localStorage.getItem(key)) || []; }
    function saveData(key, data) { localStorage.setItem(key, JSON.stringify(data)); updateDashboard(); }
    
    // --- BA≈ûLANGI√á ---
    document.addEventListener('DOMContentLoaded', () => {
        // Tarihi G√∂ster
        const options = { year: 'numeric', month: 'long', day: 'numeric', weekday: 'long' };
        document.getElementById('currentDateDisplay').textContent = new Date().toLocaleDateString('tr-TR', options);
        
        // Ay Se√ßiciyi Bug√ºne Ayarla
        // Ay Se√ßiciyi Bug√ºne Ayarla (Yerel Saat ile)
        const now = new Date();
        const currentMonthStr = `${now.getFullYear()}-${String(now.getMonth() + 1).padStart(2, '0')}`;
        document.getElementById('reportMonth').value = currentMonthStr;

        // ƒ∞lk Y√ºklemeler
        updateDashboard();
        renderAppointments();
        renderReports();
        renderEmployees();
        renderProducts();
        renderReviews();
    });

    // --- MEN√ú GE√áƒ∞≈ûƒ∞ ---
    function showSection(id) {
        document.querySelectorAll('.section').forEach(el => el.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        document.querySelectorAll('.menu-item').forEach(el => el.classList.remove('active'));
        event.currentTarget.classList.add('active');
        
        // Verileri Tazele
        if(id === 'dashboard') updateDashboard();
        if(id === 'appointments') renderAppointments();
        if(id === 'reports') renderReports();
        if(id === 'employees') renderEmployees();
        if(id === 'products') renderProducts();
        if(id === 'reviews') renderReviews();
        if(id === 'appointments') renderAppointments();
        if(id === 'reports') renderReports();
        if(id === 'calendar') renderMatrix(); // üëà YENƒ∞: Takvim sekmesine basƒ±nca matrisi √ßiz
        //
    }

    // --- 1. DASHBOARD ---
    function updateDashboard() {
        const appts = getData('appointments');
        const team = getData('teamData');
        const prods = getData('productData');
        const accounting = getData('accountingRecords');

        // Bu ayƒ±n cirosu
        const currentMonth = new Date().toISOString().slice(0, 7); // "2025-12"
        const monthlyRevenue = accounting
            .filter(rec => rec.completedAt && rec.completedAt.startsWith(currentMonth))
            .reduce((sum, rec) => sum + (rec.price || 0), 0);

        document.getElementById('stat-appt').innerText = appts.length;
        document.getElementById('stat-emp').innerText = team.length;
        document.getElementById('stat-prod').innerText = prods.length;
        document.getElementById('stat-revenue').innerText = formatMoney(monthlyRevenue);
    }

    // --- 2. RANDEVULAR ---
    function renderAppointments() {
        const list = getData('appointments');
        const tbody = document.getElementById('appt-table-body');
        tbody.innerHTML = '';

        if(list.length === 0) { tbody.innerHTML = '<tr><td colspan="5" style="text-align:center; color:#666; padding:20px;">Bekleyen randevu yok.</td></tr>'; return; }

        list.sort((a,b) => new Date(a.date+' '+a.time) - new Date(b.date+' '+b.time));

        list.forEach(item => {
            const noteIcon = item.note ? '<i class="fas fa-sticky-note" style="color:var(--info)"></i>' : '';
            tbody.innerHTML += `
                <tr>
                    <td><div style="font-weight:700; color:var(--gold)">${item.date}</div><div style="font-size:12px; color:#888">${item.time}</div></td>
                    <td>${item.customer} ${noteIcon}</td>
                    <td><div>${item.staff}</div><div style="font-size:12px; color:#aaa">${item.service}</div></td>
                    <td style="font-weight:700; color:var(--success)">${item.price} ‚Ç∫</td>
                    <td style="text-align:right;">
                        <div class="action-group" style="justify-content: flex-end;">
                            <button class="btn-icon btn-view" onclick="inspectAppt('${item.id}')" title="ƒ∞ncele"><i class="fas fa-eye"></i></button>
                            <button class="btn-icon btn-check" onclick="completeAppt('${item.id}')" title="Tamamla"><i class="fas fa-check"></i></button>
                            <button class="btn-icon btn-trash" onclick="cancelAppt('${item.id}')" title="ƒ∞ptal Et"><i class="fas fa-trash"></i></button>
                        </div>
                    </td>
                </tr>
            `;
        });
    }

    function inspectAppt(id) {
        const list = getData('appointments');
        const item = list.find(x => x.id == id);
        if(!item) return;

        const html = `
            <div class="detail-row"><span class="detail-label">M√º≈üteri:</span> <span class="detail-val">${item.customer}</span></div>
            <div class="detail-row"><span class="detail-label">Telefon:</span> <span class="detail-val">${item.phone}</span></div>
            <div class="detail-row"><span class="detail-label">Tarih:</span> <span class="detail-val">${item.date} ${item.time}</span></div>
            <div class="detail-row"><span class="detail-label">Personel:</span> <span class="detail-val">${item.staff}</span></div>
            <div class="detail-row"><span class="detail-label">ƒ∞≈ülem:</span> <span class="detail-val">${item.service}</span></div>
            <div class="detail-row"><span class="detail-label">Tutar:</span> <span class="detail-val" style="color:var(--gold); font-size:18px;">${item.price} ‚Ç∫</span></div>
            ${item.note ? `<div class="note-highlight"><i class="fas fa-quote-left"></i> ${item.note}</div>` : ''}
        `;
        document.getElementById('apptModalContent').innerHTML = html;
        document.getElementById('modalAppt').classList.add('active');
    }

    function completeAppt(id) {
        if(!confirm("Randevu tamamlandƒ± ve √ºcret kasaya i≈ülenecek. Onaylƒ±yor musun?")) return;
        
        let appts = getData('appointments');
        const index = appts.findIndex(x => x.id == id);
        if(index === -1) return;

        const completed = appts[index];
        const accounting = getData('accountingRecords');
        
        // ID kontrol√º (√áift kayƒ±t √∂nleme)
        if(!accounting.some(x => x.id == id)) {
            accounting.push({ ...completed, completedAt: new Date().toISOString() });
            saveData('accountingRecords', accounting);
        }

        appts.splice(index, 1);
        saveData('appointments', appts);
        
        renderAppointments();
        updateDashboard();
        // alert("ƒ∞≈ülem tamamlandƒ±, kasaya i≈ülendi.");
    }

    function cancelAppt(id) {
        if(!confirm("Bu randevuyu ƒ∞PTAL etmek istediƒüine emin misin? (Para kasaya girmez)")) return;
        let appts = getData('appointments');
        const index = appts.findIndex(x => x.id == id);
        if(index > -1) {
            appts.splice(index, 1);
            saveData('appointments', appts);
            renderAppointments();
            updateDashboard();
        }
    }

    // --- 3. RAPORLAR (Fƒ∞NANSAL) ---
    function renderReports() {
        const selectedMonth = document.getElementById('reportMonth').value; // "YYYY-MM"
        const accounting = getData('accountingRecords');
        const team = getData('teamData');
        const tbody = document.getElementById('report-table-body');
        
        // Filtrele
        const filteredRecords = accounting.filter(rec => rec.completedAt && rec.completedAt.startsWith(selectedMonth));
        
        // Toplam Ciro Hesapla
        const totalRevenue = filteredRecords.reduce((sum, rec) => sum + (rec.price || 0), 0);
        document.getElementById('monthly-total-display').innerText = formatMoney(totalRevenue);

        tbody.innerHTML = '';
        
        team.forEach(member => {
            // Bu personelin o ayki i≈üleri
            const jobs = filteredRecords.filter(rec => rec.staff === member.name);
            const earnings = jobs.reduce((sum, rec) => sum + (rec.price || 0), 0);
            
            tbody.innerHTML += `
                <tr>
                    <td class="user-cell">
                        <img src="${member.img || 'img/eren_team.jpeg'}" class="user-avatar" onerror="this.src='https://placehold.co/100'">
                        <div>${member.name}<br><small style="color:#666">${member.role}</small></div>
                    </td>
                    <td>${jobs.length} ƒ∞≈ülem</td>
                    <td style="color:var(--gold); font-weight:700;">${formatMoney(earnings)}</td>
                </tr>
            `;
        });
    }

    // --- 4. √áALI≈ûANLAR ---
    function renderEmployees() {
        const list = getData('teamData');
        const tbody = document.getElementById('emp-table-body');
        tbody.innerHTML = '';

        list.forEach((emp, index) => {
            tbody.innerHTML += `
                <tr style="cursor:pointer;" onclick="openEmpProfile(${index})">
                    <td class="user-cell">
                        <img src="${emp.img}" class="user-avatar" onerror="this.src='https://placehold.co/100'">
                        ${emp.name}
                    </td>
                    <td>${emp.role}</td>
                    <td>${emp.services.length} Hizmet</td>
                    <td><button class="btn-icon btn-trash" onclick="event.stopPropagation(); deleteItem('teamData', ${index});"><i class="fas fa-trash"></i></button></td>
                </tr>
            `;
        });
    }

    // √áalƒ±≈üan Ekleme
    document.getElementById('employeeForm').addEventListener('submit', (e) => {
        e.preventDefault();
        
        const selectedServices = [];
        document.querySelectorAll('input[name="services"]:checked').forEach(cb => selectedServices.push(cb.value));
        
        if(selectedServices.length === 0) { alert("En az bir hizmet se√ßmelisin dedem."); return; }

        const newEmp = {
            id: document.getElementById('empName').value.toLowerCase().replace(/\s/g, ''),
            name: document.getElementById('empName').value,
            role: document.getElementById('empRole').value,
            img: document.getElementById('empImg').value,
            desc: document.getElementById('empDesc').value,
            services: selectedServices
        };

        const list = getData('teamData');
        list.push(newEmp);
        saveData('teamData', list);
        
        renderEmployees();
        updateDashboard(); // Aktif personel sayƒ±sƒ±nƒ± g√ºncelle
        e.target.reset();
        alert("√áalƒ±≈üan ba≈üarƒ±yla eklendi!");
    });

    // √áalƒ±≈üan Detay Modalƒ± (O AYKƒ∞ PERFORMANS)
    function openEmpProfile(index) {
        const emp = getData('teamData')[index];
        const accounting = getData('accountingRecords');
        const currentMonth = new Date().toISOString().slice(0, 7);
        
        // Bu personelin bu ayki i≈üleri
        const jobs = accounting.filter(rec => rec.staff === emp.name && rec.completedAt.startsWith(currentMonth));
        const totalEarnings = jobs.reduce((sum, rec) => sum + (rec.price || 0), 0);

        let jobsHtml = '';
        if(jobs.length === 0) {
            jobsHtml = '<p style="color:#666; font-style:italic;">Bu ay hen√ºz tamamlanmƒ±≈ü randevusu yok.</p>';
        } else {
            jobsHtml = '<ul style="list-style:none; padding:0;">';
            jobs.forEach(job => {
                jobsHtml += `<li style="padding:8px 0; border-bottom:1px solid #333; display:flex; justify-content:space-between; font-size:13px;">
                    <span>${job.date} - ${job.service}</span>
                    <span style="color:var(--success)">${job.price} ‚Ç∫</span>
                </li>`;
            });
            jobsHtml += '</ul>';
        }

        const html = `
            <div style="text-align:center; margin-bottom:20px;">
                <img src="${emp.img}" style="width:100px; height:100px; border-radius:50%; border:3px solid var(--gold); object-fit:cover;">
                <h2 style="margin:10px 0 5px 0; color:var(--text-main);">${emp.name}</h2>
                <p style="color:var(--text-muted); margin:0;">${emp.role}</p>
            </div>
            
            <div style="background:#2a2a2a; padding:15px; border-radius:8px; margin-bottom:20px;">
                <h4 style="margin:0 0 10px 0; color:var(--gold); border-bottom:1px solid #444; padding-bottom:5px;">Bu Ayki Performans</h4>
                <div style="display:flex; justify-content:space-between; margin-bottom:10px;">
                    <span>Tamamlanan ƒ∞≈ü:</span> <strong>${jobs.length}</strong>
                </div>
                <div style="display:flex; justify-content:space-between;">
                    <span>Kazanƒ±lan:</span> <strong style="color:var(--gold); font-size:18px;">${formatMoney(totalEarnings)}</strong>
                </div>
            </div>

            <div style="background:#2a2a2a; padding:15px; border-radius:8px;">
                <h4 style="margin:0 0 10px 0; color:#fff; border-bottom:1px solid #444; padding-bottom:5px;">ƒ∞≈ülem Ge√ßmi≈üi (${currentMonth})</h4>
                <div style="max-height:200px; overflow-y:auto;">${jobsHtml}</div>
            </div>
        `;
        
        document.getElementById('empModalContent').innerHTML = html;
        document.getElementById('modalEmp').classList.add('active');
    }

    // --- 5. √úR√úNLER ---
    function renderProducts() {
        const list = getData('productData');
        const tbody = document.getElementById('prod-table-body');
        tbody.innerHTML = '';
        
        list.forEach((prod, index) => {
            const isChecked = prod.isFeatured ? 'checked' : '';
            // Vitrin se√ßimi i√ßin radyo buton
            tbody.innerHTML += `
                <tr>
                    <td style="text-align:center;">
                        <input type="radio" name="featProd" ${isChecked} onchange="setFeaturedProd(${index})" style="accent-color:var(--gold); cursor:pointer;">
                    </td>
                    <td class="user-cell">
                        <img src="${prod.img}" class="user-avatar" onerror="this.src='https://placehold.co/100'">
                        ${prod.name}
                    </td>
                    <td>${prod.price} ‚Ç∫</td>
                    <td><button class="btn-icon btn-trash" onclick="deleteItem('productData', ${index})"><i class="fas fa-trash"></i></button></td>
                </tr>
            `;
        });
    }

    function setFeaturedProd(idx) {
        const list = getData('productData');
        list.forEach(p => p.isFeatured = false);
        list[idx].isFeatured = true;
        saveData('productData', list);
        // alert("Vitrin √ºr√ºn√º g√ºncellendi."); // Opsiyonel
    }

    document.getElementById('productForm').addEventListener('submit', (e) => {
        e.preventDefault();
        const list = getData('productData');
        list.push({
            name: document.getElementById('prodName').value,
            price: document.getElementById('prodPrice').value,
            img: document.getElementById('prodImg').value,
            desc: document.getElementById('prodDesc').value,
            isFeatured: false
        });
        if(list.length === 1) list[0].isFeatured = true; // ƒ∞lk √ºr√ºnse vitrin yap
        saveData('productData', list);
        renderProducts();
        updateDashboard();
        e.target.reset();
        alert("√úr√ºn eklendi!");
    });

    // --- 6. YORUMLAR ---
    function renderReviews() {
        const list = getData('siteReviews');
        const tbody = document.getElementById('review-table-body');
        tbody.innerHTML = '';
        list.forEach((rev, index) => {
            tbody.innerHTML += `
                <tr>
                    <td>
                        <div style="font-weight:bold;">${rev.name}</div>
                        <div style="font-size:11px; color:#888;">${rev.type}</div>
                    </td>
                    <td style="color:var(--gold);">${'‚òÖ'.repeat(rev.rating)}</td>
                    <td style="font-size:12px; font-style:italic;">"${rev.comment}"</td>
                    <td><button class="btn-icon btn-trash" onclick="deleteItem('siteReviews', ${index})"><i class="fas fa-trash"></i></button></td>
                </tr>
            `;
        });
    }

    document.getElementById('reviewForm').addEventListener('submit', (e) => {
        e.preventDefault();
        const list = getData('siteReviews');
        list.push({
            name: document.getElementById('revName').value,
            type: document.getElementById('revTitle').value,
            rating: document.getElementById('revRating').value,
            comment: document.getElementById('revComment').value
        });
        saveData('siteReviews', list);
        renderReviews();
        e.target.reset();
        alert("Yorum yayƒ±nlandƒ±!");
    });

    // --- ORTAK & YARDIMCI ---
    function deleteItem(key, index) {
        if(confirm("Silmek istediƒüine emin misin?")) {
            const list = getData(key);
            list.splice(index, 1);
            saveData(key, list);
            // ƒ∞lgili sekmeyi yenile
            if(key === 'teamData') renderEmployees();
            if(key === 'productData') renderProducts();
            if(key === 'siteReviews') renderReviews();
            updateDashboard();
        }
    }

    function formatMoney(amount) {
        return amount.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".") + " ‚Ç∫";
    }

    function closeModal(id) { document.getElementById(id).classList.remove('active'); }
    // Modal dƒ±≈üƒ± tƒ±klama
    window.onclick = function(e) {
        if(e.target.classList.contains('modal-overlay')) {
            e.target.classList.remove('active');
        }
    }

    function logout() {
        localStorage.removeItem('isAdminLoggedIn');
        window.location.href = 'admin-login.html';
    }

    // --- Sƒ∞STEMƒ∞ SIFIRLA ---
    function resetSystem() {
        if(confirm('‚ö†Ô∏è Dƒ∞KKAT: T√ºm veriler (Randevular, √áalƒ±≈üanlar, Ciro, √úr√ºnler) KALICI OLARAK silinecek!\n\nSistemi fabrika ayarlarƒ±na d√∂nd√ºrmek istediƒüine emin misin?')) {
            localStorage.clear();
            localStorage.setItem('isAdminLoggedIn', 'true');
            alert('Sistem sƒ±fƒ±rlandƒ±. Sayfa yenileniyor...');
            location.reload();
        }
    }
    
    // --- 7. TAKVƒ∞M MATRƒ∞Sƒ∞ (TELEFON RANDEVUSU) ---
    
    function renderMatrix() {
        const dateInput = document.getElementById('matrixDate');
        if (!dateInput.value) dateInput.value = new Date().toISOString().split('T')[0]; // Bug√ºn se√ßili gelsin
        
        const selectedDate = dateInput.value;
        const team = getData('teamData');
        const appointments = getData('appointments');
        const thead = document.getElementById('matrixHead');
        const tbody = document.getElementById('matrixBody');

        // 1. Ba≈ülƒ±klarƒ± (Personel ƒ∞simleri) Olu≈ütur
        let headHtml = '<tr><th>Saat</th>';
        team.forEach(emp => {
            headHtml += `<th>${emp.name}</th>`;
        });
        headHtml += '</tr>';
        thead.innerHTML = headHtml;

        // 2. Saat Dilimlerini D√∂ng√ºye Al (10:00 - 22:00)
        tbody.innerHTML = '';
        const startHour = 10;
        const endHour = 22;

        for (let h = startHour; h < endHour; h++) {
            ['00', '30'].forEach(m => {
                const timeStr = `${h}:${m}`;
                let rowHtml = `<tr><td style="text-align:center; font-weight:bold; color:#666;">${timeStr}</td>`;

                // Her personel i√ßin o saati kontrol et
                team.forEach(emp => {
                    // Bu saatte bu personelin randevusu var mƒ±?
                    // NOT: 1 Saatlik bloklama mantƒ±ƒüƒ± burada da ge√ßerli olsun mu? 
                    // Basitlik adƒ±na direkt √ßakƒ±≈üma var mƒ± ona bakƒ±yoruz.
                    const isBusy = appointments.find(app => 
                        app.date === selectedDate && 
                        app.staff === emp.name && 
                        app.time === timeStr
                    );

                    if (isBusy) {
                        // DOLU KUTU
                        rowHtml += `
                            <td>
                                <div class="slot-btn slot-busy" title="${isBusy.customer} (${isBusy.service})">
                                    <span class="slot-status">DOLU</span>
                                    <span class="slot-time" style="font-size:9px;">${isBusy.customer.substring(0,8)}..</span>
                                </div>
                            </td>`;
                    } else {
                        // BO≈û KUTU (Tƒ±klayƒ±nca Randevu Al)
                        rowHtml += `
                            <td>
                                <button class="slot-btn slot-empty" onclick="quickBook('${selectedDate}', '${timeStr}', '${emp.name}')">
                                    <span class="slot-status">BO≈û</span>
                                    <span class="slot-time">Ekle +</span>
                                </button>
                            </td>`;
                    }
                });

                rowHtml += '</tr>';
                tbody.innerHTML += rowHtml;
            });
        }
    }

    // TELEFONLA HIZLI RANDEVU EKLEME
    function quickBook(date, time, staffName) {
        const customerName = prompt(`üìû TELEFON RANDEVUSU\n\nPersonel: ${staffName}\nTarih: ${date} Saat: ${time}\n\nM√º≈üterinin Adƒ± Soyadƒ±:`);

        if (customerName) {
            const newAppt = {
                id: Date.now(),
                staff: staffName,
                service: "Telefon Randevusu", // Varsayƒ±lan hizmet
                price: 0, // Telefonda fiyat belli olmayabilir, 0 girilir, i≈ülem bitince d√ºzeltilir
                duration: 60, // Telefonda standart 1 saat kapatalƒ±m
                date: date,
                time: time,
                customer: customerName + " (Tel)",
                phone: "-",
                note: "D√ºkkandan manuel eklendi",
                status: 'Bekliyor'
            };

            const list = getData('appointments');
            list.push(newAppt);
            saveData('appointments', list);
            
            renderMatrix(); // Tabloyu yenile
            alert("‚úÖ Randevu ba≈üarƒ±yla kapatƒ±ldƒ±!");
        }
    }

</script>

</body>
</html>
